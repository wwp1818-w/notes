https

#### https与http的区别

- https即http+tls，使用tls层进行加密

- 加密方式：对称加密传输数据，但对称加密的密钥是通过非对称加密传输的

- 获取传输的密钥过程：

  1. 客户端第一次连接服务器，服务器返回证书信息

  2. 客户端校验证书的合法性，判断ca是不是客户端可信任的ca，使用ca的公钥解密证书，获取服务器的公钥
  3. 随机生成对称加密的密钥，使用服务器的公钥进行加密，传输给服务器
  4. 服务器使用自己的私钥解密，得到对称加密的秘钥
  5. 随后使用对称加密传输数据

#### 证书

里面有服务端的个人信息，以及公钥，将个人信息和公钥进行哈希运算，得到消息摘要，再用CA的私钥进行加密，得到数字签名，防止别人替换消息摘要。数字签名会和原始的信息放一起形成数字证书

#### CA

即认证机构，会有对应的证书表明自己的身份，一般计算机会内置一些顶层的CA证书，CA证书具有层级，如果顶层的CA证书是可信任的，那么对应的底层CA也是可信任的



#### 中间人攻击

即A和B之间通信，可以被中间人C进行拦截并获取消息内容，A和B都不知道有C的存在。使用证书即可以避免中间人攻击。



#### 问题

1. 为什么要加密传输数据

   传输过程中可能被人监听，直接获取数据包查看，信息泄漏

2. 为什么不使用非对称rsa传输数据

   加解密速度慢，影响效率

3. 为什么要内置一些CA证书或者拷贝手动安装证书，不在服务器传输给客户端

   防止服务器传输CA证书时候，也被中间人攻击，得到CA证书的公钥

4. fiddler抓取https的包，原理是

   fiddler采用的中间人攻击方式原理，首先会生成唯一的顶层CA根证书，要在客户端安装信任，这样客户端才能信任fiddler伪造的服务器证书。

   fiddler会先拦截客户端请求，然后请求服务器，得到服务器证书，随后得到服务器公钥，随后发给客户端自己伪造的一个服务器证书，客户端会生成随机秘钥然后用伪造的公钥加密传给fiddler，fiddler再用伪造的私钥解密，得到对称加密的私钥。然后再用服务器的公钥进行加密传给服务器，最后就一直利用对称加密的私钥即可得到传输的数据

   